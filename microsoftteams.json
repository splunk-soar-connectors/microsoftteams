{
    "appid": "6ba1906f-5899-44df-bb65-1bee4df8ca3c",
    "name": "Microsoft Teams",
    "description": "This app integrates with Microsoft Teams to support various generic and investigative actions",
    "type": "information",
    "product_vendor": "Microsoft",
    "logo": "logo_microsoftteams.svg",
    "logo_dark": "logo_microsoftteams_dark.svg",
    "product_name": "Teams",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "license": "Copyright (c) 2019 Splunk Inc.",
    "app_version": "1.0.6",
    "utctime_updated": "2019-04-03T21:00:05.000000Z",
    "package_name": "phantom_microsoftteams",
    "main_module": "microsoftteams_connector.pyc",
    "min_phantom_version": "4.0.1068",
    "app_wizard_version": "1.0.0",
    "rest_handler": "microsoftteams_connector._handle_rest_request",
    "configuration": {
        "client_id": {
            "description": "Client ID",
            "data_type": "string",
            "required": true,
            "order": 0
        },
        "client_secret": {
            "description": "Client Secret",
            "data_type": "password",
            "required": true,
            "order": 1
        },
        "tenant_id": {
            "description": "Tenant ID",
            "data_type": "string",
            "required": true,
            "order": 2
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "identifier": "test_connectivity",
            "description": "Validate the asset configuration for connectivity using supplied configuration",
            "verbose": "You need to take admin consent first if you're a non-admin user",
            "type": "test",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "get admin consent",
            "identifier": "get_admin_consent",
            "description": "Get admin consent",
            "verbose": "Action <b>'get admin consent'</b> has to be run by an admin user to provide consent to a non-admin user",
            "type": "generic",
            "read_only": true,
            "parameters": {},
            "render": {
                "type": "table"
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ],
                    "column_name": "Status",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Admin consent Received"
                    ],
                    "column_name": "Message",
                    "column_order": 0
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "versions": "EQ(*)"
        },
        {
            "action": "list users",
            "identifier": "list_users",
            "description": "List all users",
            "type": "investigate",
            "read_only": true,
            "parameters": {},
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.accountEnabled",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.assignedLicenses.*.disabledPlans",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.assignedLicenses.*.skuId",
                    "data_type": "string",
                    "example_values": [
                        "6fd2c87f-b296-42f0-b197-1e91e994b900"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assignedPlans.*.assignedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2018-01-24T11:17:21Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assignedPlans.*.capabilityStatus",
                    "data_type": "string",
                    "example_values": [
                        "Enabled"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assignedPlans.*.service",
                    "data_type": "string",
                    "example_values": [
                        "exchange"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assignedPlans.*.servicePlanId",
                    "data_type": "string",
                    "example_values": [
                        "efb87545-963c-4e0d-99df-69c6916d9eb0"
                    ]
                },
                {
                    "data_path": "action_result.data.*.businessPhones",
                    "data_type": "string",
                    "example_values": [
                        "22211156"
                    ]
                },
                {
                    "data_path": "action_result.data.*.city",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.companyName",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.country",
                    "data_type": "string",
                    "example_values": [
                        "US"
                    ]
                },
                {
                    "data_path": "action_result.data.*.deletedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2018-01-24T11:16:50Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.department",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.deviceKeys",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.displayName",
                    "data_type": "string",
                    "example_values": [
                        "John Smith"
                    ],
                    "contains": [
                        "user name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.employeeId",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.givenName",
                    "data_type": "string",
                    "example_values": [
                        "John"
                    ],
                    "contains": [
                        "user name"
                    ],
                    "column_name": "First Name",
                    "column_order": "1"
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "a1a6d0a2-b0f6-46c1-b49e-98a9ddabac09"
                    ],
                    "column_name": "User ID",
                    "column_order": "0"
                },
                {
                    "data_path": "action_result.data.*.imAddresses",
                    "data_type": "string",
                    "example_values": [
                        "test@abc.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.jobTitle",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.legalAgeGroupClassification",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.mail",
                    "data_type": "string",
                    "example_values": [
                        "john.smith@abc.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ],
                    "column_name": "Email",
                    "column_order": "3"
                },
                {
                    "data_path": "action_result.data.*.mailNickname",
                    "data_type": "string",
                    "example_values": [
                        "John"
                    ],
                    "contains": [
                        "user name"
                    ]
                },
                {
                    "data_path": "action_result.data.*.mobilePhone",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.officeLocation",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesDomainName",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ],
                    "contains": [
                        "domain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesExtensionAttributes",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesImmutableId",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesLastSyncDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2018-01-24T11:16:50Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesProvisioningErrors",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesSamAccountName",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesSecurityIdentifier",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesSyncEnabled",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesUserPrincipalName",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.passwordPolicies",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.passwordProfile",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.postalCode",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.preferredDataLocation",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.preferredLanguage",
                    "data_type": "string",
                    "example_values": [
                        "en"
                    ]
                },
                {
                    "data_path": "action_result.data.*.provisionedPlans.*.capabilityStatus",
                    "data_type": "string",
                    "example_values": [
                        "Enabled"
                    ]
                },
                {
                    "data_path": "action_result.data.*.provisionedPlans.*.provisioningStatus",
                    "data_type": "string",
                    "example_values": [
                        "Success"
                    ]
                },
                {
                    "data_path": "action_result.data.*.provisionedPlans.*.service",
                    "data_type": "string",
                    "example_values": [
                        "exchange"
                    ]
                },
                {
                    "data_path": "action_result.data.*.proxyAddresses",
                    "data_type": "string",
                    "example_values": [
                        "SMTP:test@abc.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.refreshTokensValidFromDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2018-01-24T11:16:50Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.showInAddressList",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.state",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.streetAddress",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.surname",
                    "data_type": "string",
                    "example_values": [
                        "Smith"
                    ],
                    "column_name": "Surname",
                    "column_order": "2"
                },
                {
                    "data_path": "action_result.data.*.usageLocation",
                    "data_type": "string",
                    "example_values": [
                        "US"
                    ]
                },
                {
                    "data_path": "action_result.data.*.userPrincipalName",
                    "data_type": "string",
                    "example_values": [
                        "john.smith@abc.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.userType",
                    "data_type": "string",
                    "example_values": [
                        "Member"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_users",
                    "data_type": "numeric",
                    "example_values": [
                        5
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total users: 5"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "send message",
            "identifier": "send_message",
            "description": "Send message to a channel of a group",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "group_id": {
                    "description": "ID of group",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "ms teams group id"
                    ],
                    "order": 0
                },
                "channel_id": {
                    "description": "ID of channel",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "ms teams channel id"
                    ],
                    "order": 1
                },
                "message": {
                    "description": "Message to send",
                    "data_type": "string",
                    "required": true,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.channel_id",
                    "data_type": "string",
                    "contains": [
                        "ms teams channel id"
                    ],
                    "column_name": "Channel ID",
                    "column_order": 1,
                    "example_values": [
                        "cd6f5efb-39f8-492e-80cd-c228c211cf17"
                    ]
                },
                {
                    "data_path": "action_result.parameter.group_id",
                    "data_type": "string",
                    "contains": [
                        "ms teams group id"
                    ],
                    "column_name": "Group ID",
                    "column_order": 0,
                    "example_values": [
                        "594101ba-1fde-482d-8e24-3bbab23a3ca8"
                    ]
                },
                {
                    "data_path": "action_result.parameter.message",
                    "data_type": "string",
                    "column_name": "message",
                    "column_order": 2,
                    "example_values": [
                        "message from phantom"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://graph.microsoft.com/beta/$metadata#chatThreads/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "1517826451101"
                    ],
                    "column_name": "Message ID",
                    "column_order": 3
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Id: 1517826451101"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list channels",
            "identifier": "list_channels",
            "description": "Lists all channels of a group",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "group_id": {
                    "description": "ID of group",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "ms teams group id"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.parameter.group_id",
                    "data_type": "string",
                    "contains": [
                        "ms teams group id"
                    ],
                    "example_values": [
                        "caf444a0-0e0e-426b-98ea-db67ff6b0b25"
                    ]
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string",
                    "example_values": [
                        "Test team"
                    ]
                },
                {
                    "data_path": "action_result.data.*.displayName",
                    "data_type": "string",
                    "example_values": [
                        "General"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "78f4a378-e7d3-49c8-a8a7-645b886752d9"
                    ],
                    "contains": [
                        "ms teams channel id"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_channels",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total channels: 3"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "view": "microsoftteams_view.display_view"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list groups",
            "identifier": "list_groups",
            "description": "List all groups",
            "type": "investigate",
            "read_only": true,
            "parameters": {},
            "render": {
                "type": "table"
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success",
                        "failed"
                    ]
                },
                {
                    "data_path": "action_result.data.*.classification",
                    "data_type": "string",
                    "example_values": [
                        "classification"
                    ]
                },
                {
                    "data_path": "action_result.data.*.createdDateTime",
                    "data_type": "string",
                    "column_name": "Created On",
                    "column_order": 2,
                    "example_values": [
                        "2018-01-30T09:43:13Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.deletedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2018-01-30T09:43:13Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.description",
                    "data_type": "string",
                    "example_values": [
                        "team2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.displayName",
                    "data_type": "string",
                    "column_name": "Name",
                    "column_order": 1,
                    "example_values": [
                        "team2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.groupTypes",
                    "data_type": "string",
                    "example_values": [
                        "Unified",
                        "DynamicMembership"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "column_name": "Group ID",
                    "column_order": 0,
                    "example_values": [
                        "594101ba-1fde-482d-8e24-3bbab23a3ca8"
                    ],
                    "contains": [
                        "ms teams group id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.mail",
                    "data_type": "string",
                    "example_values": [
                        "team2@test.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.mailEnabled",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.mailNickname",
                    "data_type": "string",
                    "example_values": [
                        "team2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.membershipRule",
                    "data_type": "string",
                    "example_values": [
                        "user.department -eq \"Marketing\""
                    ]
                },
                {
                    "data_path": "action_result.data.*.membershipRuleProcessingState",
                    "data_type": "string",
                    "example_values": [
                        "on",
                        "off"
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesLastSyncDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2018-01-30T09:43:13Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesProvisioningErrors",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesSecurityIdentifier",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.onPremisesSyncEnabled",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.preferredDataLocation",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.preferredLanguage",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.proxyAddresses",
                    "data_type": "string",
                    "example_values": [
                        "SMTP : team2@test.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.renewedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2018-01-30T09:43:13Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.resourceBehaviorOptions",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.resourceProvisioningOptions",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.securityEnabled",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.theme",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "action_result.data.*.visibility",
                    "data_type": "string",
                    "column_name": "Visibility",
                    "column_order": 3,
                    "example_values": [
                        "Private",
                        "Public"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_groups",
                    "data_type": "numeric",
                    "example_values": [
                        4
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total groups: 3"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "versions": "EQ(*)"
        }
    ]
}